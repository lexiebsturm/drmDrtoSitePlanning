y = "Latitude") +
# Set theme and adjust the appearance
theme_minimal() +
theme(
legend.title = element_text(size = 12, face = "bold"),
legend.position = "right"  # Position the legend on the right
) +
# Set the coordinate system limits based on the bounding box of the points
coord_cartesian(xlim = c(bbox["xmin"], bbox["xmax"]), ylim = c(bbox["ymin"], bbox["ymax"]))
# Display the map
print(prPlot)
# Create the map with Puerto Rico shapefile
prPlot <- ggplot() +
# Add the bathymetric base map
geom_raster(data = bathymetry_df, aes(x = lon, y = lat, fill = depth)) +
scale_fill_viridis_c(name = "Depth (m)", option = "C", direction = -1) +  # Reverse color scale
# Add the high-resolution shapefile of Puerto Rico
geom_sf(data = puerto_rico, fill = NA, color = "black") +
# Add the sites with colors based on SURVEY_TYPE
geom_point(data = sites_prico, aes(x = LON_DEGREES, y = LAT_DEGREES, color = SURVEY_TYPE), size = 3, shape = 19) +
scale_color_manual(
values = c("Fish & Benthic" = "#fdfc6d", "Fish" = "#0185a9", "Benthic" = "#e84c00"),
name = "Survey Type"
) +
# Add labels and titles
labs(title = "Sites and Bathymetry in Puerto Rico",
x = "Longitude",
y = "Latitude") +
# Set theme and adjust the appearance
theme_minimal() +
theme(
legend.title = element_text(size = 12, face = "bold"),
legend.position = "right"  # Position the legend on the right
) +
coord_sf()  # Use the default coordinate system
# Display the map
print(prPlot)
# Create the map with Puerto Rico shapefile
prPlot <- ggplot() +
# Add the bathymetric base map
geom_raster(data = bathymetry_df, aes(x = lon, y = lat, fill = depth)) +
scale_fill_gradient(low = "#d0e0f0", high = "#00274d", name = "Depth (m)", na.value = "transparent") +  # Light to dark blue gradient
# Add the high-resolution shapefile of Puerto Rico
geom_sf(data = puerto_rico, fill = NA, color = "black") +
# Add the sites with colors based on SURVEY_TYPE
geom_point(data = sites_prico, aes(x = LON_DEGREES, y = LAT_DEGREES, color = SURVEY_TYPE), size = 3, shape = 19) +
scale_color_manual(
values = c("Fish & Benthic" = "#fdfc6d", "Fish" = "#0185a9", "Benthic" = "#e84c00"),
name = "Survey Type"
) +
# Add labels and titles
labs(title = "Sites and Bathymetry in Puerto Rico",
x = "Longitude",
y = "Latitude") +
# Set theme and adjust the appearance
theme_minimal() +
theme(
legend.title = element_text(size = 12, face = "bold"),
legend.position = "right"  # Position the legend on the right
) +
coord_sf()  # Use the default coordinate system
# Display the map
print(prPlot)
# Create the map with Puerto Rico shapefile
prPlot <- ggplot() +
# Add the high-resolution shapefile of Puerto Rico
geom_sf(data = puerto_rico, fill = "white", color = "black") +
# Add the bathymetric base map
geom_raster(data = bathymetry_df, aes(x = lon, y = lat, fill = depth)) +
scale_fill_gradient(low = "#d0e0f0", high = "#00274d", name = "Depth (m)", na.value = "transparent") +  # Light to dark blue gradient
# Add the sites with colors based on SURVEY_TYPE
geom_point(data = sites_prico, aes(x = LON_DEGREES, y = LAT_DEGREES, color = SURVEY_TYPE), size = 3, shape = 19) +
scale_color_manual(
values = c("Fish & Benthic" = "#fdfc6d", "Fish" = "#0185a9", "Benthic" = "#e84c00"),
name = "Survey Type"
) +
# Add labels and titles
labs(title = "Sites and Bathymetry in Puerto Rico",
x = "Longitude",
y = "Latitude") +
# Set theme and adjust the appearance
theme_minimal() +
theme(
legend.title = element_text(size = 12, face = "bold"),
legend.position = "right"  # Position the legend on the right
) +
coord_sf()  # Use the default coordinate system
# Display the map
print(prPlot)
# Create the map with Puerto Rico shapefile
prPlot <- ggplot() +
# Add the bathymetric base map
geom_raster(data = bathymetry_df, aes(x = lon, y = lat, fill = depth)) +
scale_fill_gradient(low = "#d0e0f0", high = "#00274d", name = "Depth (m)", na.value = "transparent") +  # Light to dark blue gradient
# Add the high-resolution shapefile of Puerto Rico
geom_sf(data = puerto_rico, fill = "white", color = "black") +
# Add the sites with colors based on SURVEY_TYPE
geom_point(data = sites_prico, aes(x = LON_DEGREES, y = LAT_DEGREES, color = SURVEY_TYPE), size = 3, shape = 19) +
scale_color_manual(
values = c("Fish & Benthic" = "#fdfc6d", "Fish" = "#0185a9", "Benthic" = "#e84c00"),
name = "Survey Type"
) +
# Add labels and titles
labs(title = "Sites and Bathymetry in Puerto Rico",
x = "Longitude",
y = "Latitude") +
# Set theme and adjust the appearance
theme_minimal() +
theme(
legend.title = element_text(size = 12, face = "bold"),
legend.position = "right"  # Position the legend on the right
) +
coord_sf()  # Use the default coordinate system
# Display the map
print(prPlot)
# Create the map with Puerto Rico shapefile
prPlot <- ggplot() +
# Add the bathymetric base map
geom_raster(data = bathymetry_df, aes(x = lon, y = lat, fill = depth)) +
scale_fill_gradient(low = "darkblue", high = "white", name = "Depth (m)", na.value = "transparent") +  # Light to dark blue gradient
# Add the high-resolution shapefile of Puerto Rico
geom_sf(data = puerto_rico, fill = "white", color = "black") +
# Add the sites with colors based on SURVEY_TYPE
geom_point(data = sites_prico, aes(x = LON_DEGREES, y = LAT_DEGREES, color = SURVEY_TYPE), size = 3, shape = 19) +
scale_color_manual(
values = c("Fish & Benthic" = "#fdfc6d", "Fish" = "#0185a9", "Benthic" = "#e84c00"),
name = "Survey Type"
) +
# Add labels and titles
labs(title = "Sites and Bathymetry in Puerto Rico",
x = "Longitude",
y = "Latitude") +
# Set theme and adjust the appearance
theme_minimal() +
theme(
legend.title = element_text(size = 12, face = "bold"),
legend.position = "right"  # Position the legend on the right
) +
coord_sf()  # Use the default coordinate system
# Display the map
print(prPlot)
# Create the map with Puerto Rico shapefile
prPlot <- ggplot() +
# Add the bathymetric base map
geom_raster(data = bathymetry_df, aes(x = lon, y = lat, fill = depth)) +
scale_fill_gradient(low = "blue", high = "white", name = "Depth (m)", na.value = "transparent") +  # Light to dark blue gradient
# Add the high-resolution shapefile of Puerto Rico
geom_sf(data = puerto_rico, fill = "white", color = "black") +
# Add the sites with colors based on SURVEY_TYPE
geom_point(data = sites_prico, aes(x = LON_DEGREES, y = LAT_DEGREES, color = SURVEY_TYPE), size = 3, shape = 19) +
scale_color_manual(
values = c("Fish & Benthic" = "#fdfc6d", "Fish" = "#0185a9", "Benthic" = "#e84c00"),
name = "Survey Type"
) +
# Add labels and titles
labs(title = "Sites and Bathymetry in Puerto Rico",
x = "Longitude",
y = "Latitude") +
# Set theme and adjust the appearance
theme_minimal() +
theme(
legend.title = element_text(size = 12, face = "bold"),
legend.position = "right"  # Position the legend on the right
) +
coord_sf()  # Use the default coordinate system
# Display the map
print(prPlot)
knitr::opts_chunk$set(echo = FALSE, warning = FALSE, message = FALSE)
setwd(dirname(rstudioapi::getActiveDocumentContext()$path))
getwd()
############################################## Puerto Rico ##################################################
# combine density, mortality, and size data
a <- PR_weightedmeans %>% dplyr::select(REGION, YEAR, SPECIES_CD, avDen, CV, SE) %>% dplyr::rename("SE_avDen" = SE)
knitr::opts_chunk$set(echo = FALSE, warning = FALSE, message = FALSE)
setwd(dirname(rstudioapi::getActiveDocumentContext()$path))
getwd()
if (!require("pacman")) install.packages("pacman")
pacman::p_load("paletteer", "patchwork", "tidyverse", "vegan",  "dplyr", "ncrmp.benthics.analysis", "ggplot2", "sf", "maps", "ggmap", "ggspatial", "tigris", "glue", "ggpubr", "multcomp", "ggbreak", "cowplot", "viridis", "magrittr", "gridExtra", "rcartocolor", "sp", "ggpubr", "extrafont", "ggthemes", "egg")
pacman::p_load("paletteer", "patchwork", "tidyverse", "vegan",  "dplyr", "ncrmp.benthics.analysis", "ggplot2", "sf", "maps", "ggmap", "ggspatial", "tigris", "glue", "ggpubr", "multcomp", "ggbreak", "cowplot", "viridis", "magrittr", "gridExtra", "rcartocolor", "sp", "ggpubr", "extrafont", "ggthemes", "egg")
# Support functions
#User options
user <- "Lexie"
if (user=="Lexie") {
source("C:/Users/Lexie.Sturm/Documents/ncrmp/Analysis_Rmd/Tech_Memo_Rmds/theme_publication.R")
source("C:/Users/Lexie.Sturm/Documents/ncrmp/Analysis_Rmd/Tech_Memo_Rmds/labeler.R")
} else {
#source("C:\\Users\\Sarah.Groves\\Documents\\R packages\\NCRMP\\Analysis_Rmd\\theme_publication.R")
source("H:\\Projects\\NCRMP\\NCRMP_QAQC\\Analysis_Rmd\\Tech_Memo_Rmds\\theme_publication.R")
#source("C:\\Users\\Sarah.Groves\\Documents\\R packages\\NCRMP\\Analysis_Rmd\\labeler.R")
source("H:\\Projects\\NCRMP\\NCRMP_QAQC\\Analysis_Rmd\\Tech_Memo_Rmds\\labeler.R")
}
# YEAR DEPENDENT Objects (update as appropriate)
## Variables
samp_year <- max(ncrmp.benthics.analysis::USVI_2023_NTOT$YEAR)
current_year <- 2023
## Tables/Data frames
### Cover
STTSTJ_Cvr <- NCRMP_STTSTJ_2013_23_cover_region
STX_Cvr <- NCRMP_STX_2015_23_cover_region
PR_Cvr <- NCRMP_PRICO_2014_23_cover_region
# Density
STTSTJ_den <- NCRMP_STTSTJ_2013_23_density_region
STX_den <- NCRMP_STX_2015_23_density_region
PR_den <- NCRMP_PRICO_2014_23_density_region
# Old Mortality
STTSTJ_om <- NCRMP_STTSTJ_2013_23_old_mort_region
STX_om <- NCRMP_STX_2015_23_old_mort_region
PR_om <- NCRMP_PRICO_2014_23_old_mort_region
# Recent Mortality
STTSTJ_rm <- NCRMP_STTSTJ_2013_23_rec_mort_region
STX_rm <- NCRMP_STX_2015_23_rec_mort_region
PR_rm <- NCRMP_PRICO_2014_23_rec_mort_region
# Surface Area
STTSTJ_s <- NCRMP_STTSTJ_2013_23_col_size_region
STX_s <- NCRMP_STX_2015_23_col_size_region
PR_s <- NCRMP_PRICO_2014_23_col_size_region
### Bleaching
STTSTJ_ble_prev <- NCRMP_STTSTJ_2013_23_ble_prev_species_region
STX_ble_prev <- NCRMP_STX_2015_23_ble_prev_species_region
PR_ble_prev <- NCRMP_PRICO_2014_23_ble_prev_species_region
### Disease
STTSTJ_dis_prev <- NCRMP_STTSTJ_2013_23_dis_prev_species_region
STX_dis_prev <- NCRMP_STX_2015_23_dis_prev_species_region
PR_dis_prev <- NCRMP_PRICO_2014_23_dis_prev_species_region
## Density - Species (Update table object)
STTSTJ_des.species <- NCRMP_STTSTJ_2013_23_density_species
STX_des.species <- NCRMP_STX_2015_23_density_species
PR_des.species <- NCRMP_PRICO_2014_23_density_species
# Occ Den CV
STTSTJ_Occ <- filter(NCRMP_STTSTJ_Occ_Den_CV ,
YEAR == samp_year)
STX_Occ <- filter(NCRMP_STX_Occ_Den_CV,
YEAR == samp_year)
PR_Occ <- filter(NCRMP_PRICO_Occ_Den_CV,
YEAR == samp_year)
STTSTJ_Occ_20 <- filter(NCRMP_STTSTJ_Occ_Den_CV_20 ,
YEAR == samp_year)%>% dplyr::ungroup()
STX_Occ_20 <- filter(NCRMP_STX_Occ_Den_CV_20,
YEAR == samp_year)%>% dplyr::ungroup()
PR_Occ_20 <- filter(NCRMP_PRICO_Occ_Den_CV_20,
YEAR == samp_year) %>% dplyr::ungroup()
## Weighted Means, used for Density plot (Update table object)
STTSTJ_weightedmeans <- dplyr::filter(NCRMP_STTSTJ_Occ_Den_CV, YEAR == max(NCRMP_STTSTJ_Occ_Den_CV$YEAR))
STX_weightedmeans <- dplyr::filter(NCRMP_STX_Occ_Den_CV, YEAR == max(NCRMP_STX_Occ_Den_CV$YEAR))
PR_weightedmeans <- dplyr::filter(NCRMP_PRICO_Occ_Den_CV, YEAR == max(NCRMP_PRICO_Occ_Den_CV$YEAR))
# Create a list of the species that have CV less that 20% for all Carib
spp_cv <- dplyr::bind_rows(STTSTJ_Occ_20 %>% dplyr::select(YEAR, SPECIES_CD),
STX_Occ_20 %>% dplyr::select(YEAR, SPECIES_CD),
PR_Occ_20 %>% dplyr::select(YEAR, SPECIES_CD)) %>%
unique(.)
# BW UPDATED 4/11/23
#NCRMP_ESA_FOI_species does not have 2023 data?
n_sites <- NCRMP_ESA_FOI_species %>%
# filter to Carib regions
dplyr::filter(REGION == "STX" | REGION == "STTSTJ" | REGION == "PRICO") %>%
# filter to sample year
dplyr::filter(YEAR == samp_year) %>%
dplyr::select(REGION, YEAR, Nsites) %>%
dplyr::distinct(.) %>%
# sum USVI
dplyr::mutate(region2 = case_when(REGION == "STX" | REGION == "STTSTJ" ~ "USVI",
REGION == "PRICO" ~ "PR")) %>%
dplyr::group_by(region2) %>%
dplyr::summarize(Nsites = sum(Nsites))
Carib_ESA <- NCRMP_ESA_FOI_species %>%
# filter to Carib regions
dplyr::filter(REGION == "STX" | REGION == "STTSTJ" | REGION == "PRICO") %>%
# filter to sample year
dplyr::filter(YEAR == samp_year) %>%
# group USVI data as one
dplyr::mutate(region2 = case_when(REGION == "STX" | REGION == "STTSTJ" ~ "USVI",
REGION == "PRICO" ~ "PR")) %>%
dplyr::group_by(region2, species) %>%
dplyr::summarize(N = sum(N)) %>%
dplyr::left_join(., n_sites, by = "region2") %>%
dplyr::mutate(foi = N/Nsites)
#source("C:/Users/Lexie.Sturm/Documents/GitHub/NCRMP-USVI-PR-Tech-Memo/NK Updated Scripts/NCRMP_DRM_calculate_mortality_LS.R")
# # load species specific mortality
STTSTJ_mort <- NCRMP_DRM_calculate_mortality(region = "STTSTJ" , project = "NCRMP") ##FLAG check if this is already created via export summaries. it should bw
STTSTJ_om_spp <- STTSTJ_mort$Domain_est_old_mort_species
STTSTJ_rm_spp <- STTSTJ_mort$Domain_est_rec_mort_species
STX_mort <- NCRMP_DRM_calculate_mortality(region = "STX" , project = "NCRMP")
STX_om_spp <- STX_mort$Domain_est_old_mort_species
STX_rm_spp <- STX_mort$Domain_est_rec_mort_species
PR_mort <- NCRMP_DRM_calculate_mortality(region = "PRICO" , project = "NCRMP")
PR_om_spp <- PR_mort$Domain_est_old_mort_species
PR_rm_spp <- PR_mort$Domain_est_rec_mort_species
# # load species specific size -
# # note this is not standardized by mortality though*
#source("C:/Users/Lexie.Sturm/Documents/GitHub/NCRMP-USVI-PR-Tech-Memo/NK Updated Scripts/NCRMP_DRM_calculate_mean_colony_size_LS.R")
STTSTJ_s_spp <- NCRMP_DRM_calculate_mean_colony_size(region = "STTSTJ", project = "NCRMP")
STTSTJ_s_spp <- STTSTJ_s_spp$Domain_est_species
STX_s_spp <- NCRMP_DRM_calculate_mean_colony_size(region = "STX", project = "NCRMP")
STX_s_spp <- STX_s_spp$Domain_est_species
PR_s_spp <- NCRMP_DRM_calculate_mean_colony_size(region = "PRICO", project = "NCRMP")
PR_s_spp <- PR_s_spp$Domain_est_species
############################################## Puerto Rico ##################################################
# combine density, mortality, and size data
a <- PR_weightedmeans %>% dplyr::select(REGION, YEAR, SPECIES_CD, avDen, CV, SE) %>% dplyr::rename("SE_avDen" = SE)
b <- PR_om_spp %>% dplyr::mutate(SPECIES_CD = SPECIES_NAME) %>% dplyr::select(REGION, YEAR, SPECIES_CD, avMort, SE) %>%
dplyr::rename("avMortOld" = avMort,
"SE_avMortOld" = SE)
c <- PR_s_spp %>% dplyr::mutate(SPECIES_CD = SPECIES_NAME) %>% dplyr::select(REGION, YEAR, SPECIES_CD, avMaxdiam, SE_maxdiam)
d <- PR_rm_spp %>% dplyr::mutate(SPECIES_CD = SPECIES_NAME) %>% dplyr::select(REGION, YEAR, SPECIES_CD, avMort, SE) %>%
dplyr::rename("avMortRec" = avMort,
"SE_avMortRec" = SE)
# combine density, mortality, and size data
newdat <- a %>%
dplyr::left_join(., b) %>%
dplyr::left_join(., c) %>%
dplyr::left_join(., d) %>%
arrange(desc(avDen)) %>%
dplyr::filter(CV < 1) %>%
mutate(REGION = "Puerto Rico")
spp_levels <- newdat %>% dplyr::arrange(avDen)
spp_levels <- spp_levels$SPECIES_CD
newdat <- newdat %>% dplyr::mutate(SPECIES_CD = factor(SPECIES_CD, levels = spp_levels))
# density by species for each region
dens_plot <- newdat %>%
ggplot(aes(x = avDen, y = SPECIES_CD)) +
geom_point(stat = "identity", size = 3.75) +
geom_errorbarh(aes(xmin = avDen - SE_avDen, xmax = avDen + SE_avDen, y = SPECIES_CD), height = 0.2, color = "black") +
theme_light() +
labs(x = expression(Density~(corals/m^{2})),
y = "") +
theme_Publication(base_size = 20) +
theme(axis.text.y = element_text(face = "italic"))
# density by species for each region
dens_plot <- newdat %>%
ggplot(aes(x = avDen, y = SPECIES_CD)) +
geom_point(stat = "identity", size = 3.75) +
geom_errorbarh(aes(xmin = avDen - SE_avDen, xmax = avDen + SE_avDen, y = SPECIES_CD), height = 0.2, color = "black") +
theme_light() +
labs(x = expression(Density~(corals/m^{2})),
y = "") +
theme_Publication(base_size = 20) +
theme(axis.text.y = element_text(face = "italic"))
om_plot <- newdat %>%
ggplot(aes(x = avMortOld, y = SPECIES_CD)) +
geom_errorbarh(aes(xmin = avMortOld - SE_avMortOld, xmax = avMortOld + SE_avMortOld, y = SPECIES_CD), height = 0.2, color = "black") +
geom_point(stat = "identity", size = 3.75) +
theme_light() +
labs(x = expression(Old~mortality~("%")),
y = "") +
theme_Publication(base_size = 20) +
theme(axis.text.y = element_blank(),
axis.title.y = element_blank())
om_plot <- newdat %>%
ggplot(aes(x = avMortOld, y = SPECIES_CD)) +
geom_errorbarh(aes(xmin = avMortOld - SE_avMortOld, xmax = avMortOld + SE_avMortOld, y = SPECIES_CD), height = 0.2, color = "black") +
geom_point(stat = "identity", size = 3.75) +
theme_light() +
labs(x = expression(Old~mortality~("%")),
y = "") +
theme_Publication(base_size = 20) +
theme(axis.text.y = element_blank(),
axis.title.y = element_blank())
rm_plot <- newdat %>%
ggplot(aes(x = avMortRec, y = SPECIES_CD)) +
geom_errorbarh(aes(xmin = avMortRec - SE_avMortRec, xmax = avMortRec + SE_avMortRec, y = SPECIES_CD), height = 0.2, color = "black") +
geom_point(stat = "identity", size = 3.75) +
theme_light() +
labs(x = expression(Recent~mortality~("%")),
y = "") +
theme_Publication(base_size = 20) +
theme(axis.text.y = element_blank(),
axis.title.y = element_blank())
size_plot <- newdat %>%
ggplot(aes(x = avMaxdiam, y = SPECIES_CD)) +
geom_errorbarh(aes(xmin = avMaxdiam - SE_maxdiam, xmax = avMaxdiam + SE_maxdiam, y = SPECIES_CD), height = 0.2, color = "black") +
geom_point(stat = "identity", size = 3.75) +
theme_light() +
labs(x = expression(Maximum~diameter~(cm)),
y = "") +
theme_Publication(base_size = 20) +
theme(axis.text.y = element_blank(),
axis.title.y = element_blank())
plot_spp_demo_PR <- egg::ggarrange(dens_plot,
size_plot,
om_plot,
rm_plot,
nrow = 1,
top = text_grob("Puerto Rico",
face = "bold", size = 24, hjust = -0.25))
ggsave(plot=plot_spp_demo_PR,
paste("PR.den_mort_size_spp_", ".jpeg", sep=""),
path = "C:/Users/Lexie.Sturm/Documents/GitHub/NCRMP-USVI-PR-Tech-Memo/figs",
width = 18,
height = 12.5,
dpi = 300)
############################################### St. Thomas and St. John ####################################################
# combine density, mortality, and size data
a <- STTSTJ_weightedmeans %>% dplyr::select(REGION, YEAR, SPECIES_CD, avDen, CV, SE) %>% dplyr::rename("SE_avDen" = SE)
b <- STTSTJ_om_spp %>% dplyr::mutate(SPECIES_CD = SPECIES_NAME) %>% dplyr::select(REGION, YEAR, SPECIES_CD, avMort, SE) %>%
dplyr::rename("avMortOld" = avMort,
"SE_avMortOld" = SE)
c <- STTSTJ_s_spp %>% dplyr::mutate(SPECIES_CD = SPECIES_NAME) %>% dplyr::select(REGION, YEAR, SPECIES_CD, avMaxdiam, SE_maxdiam)
d <- STTSTJ_rm_spp %>% dplyr::mutate(SPECIES_CD = SPECIES_NAME) %>% dplyr::select(REGION, YEAR, SPECIES_CD, avMort, SE) %>%
dplyr::rename("avMortRec" = avMort,
"SE_avMortRec" = SE)
# combine density, mortality, and size data
newdat <- a %>%
dplyr::left_join(., b) %>%
dplyr::left_join(., c) %>%
dplyr::left_join(., d) %>%
arrange(desc(avDen)) %>%
dplyr::filter(CV < 1) %>%
mutate(REGION = "St. Thomas & St. John")
# combine density, mortality, and size data
newdat <- a %>%
dplyr::left_join(., b) %>%
dplyr::left_join(., c) %>%
dplyr::left_join(., d) %>%
arrange(desc(avDen)) %>%
dplyr::filter(CV < 1) %>%
mutate(REGION = "St. Thomas & St. John")
spp_levels <- newdat %>% dplyr::arrange(avDen)
spp_levels <- spp_levels$SPECIES_CD
newdat <- newdat %>% dplyr::mutate(SPECIES_CD = factor(SPECIES_CD, levels = spp_levels))
om_plot <- newdat %>%
ggplot(aes(x = avMortOld, y = SPECIES_CD)) +
geom_point(stat = "identity", size = 3.75) +
geom_errorbar(aes(xmin = avMortOld - SE_avMortOld, xmax = avMortOld + SE_avMortOld), width = 0.2, color = "black") +
theme_light() +
labs(x = expression(Old~mortality~("%")),
y = "") +
theme_Publication(base_size = 20) +
theme(axis.text.y = element_blank(),
axis.title.y = element_blank())
size_plot <- newdat %>%
ggplot(aes(x = avMaxdiam, y = SPECIES_CD)) +
geom_point(stat = "identity", size = 3.75) +
geom_errorbar(aes(xmin = avMaxdiam - SE_maxdiam, xmax = avMaxdiam + SE_maxdiam), width = 0.2, color = "black") +
theme_light() +
labs(x = expression(Maximum~diameter~(cm)),
y = "") +
theme_Publication(base_size = 20) +
theme(axis.text.y = element_blank(),
axis.title.y = element_blank())
plot_spp_demo <- egg::ggarrange(dens_plot,
size_plot,
om_plot,
rm_plot,
nrow = 1,
top = text_grob("St. Thomas and St. John",
face = "bold", size = 24, hjust = 0.23))
plot_spp_demo <- egg::ggarrange(dens_plot,
size_plot,
om_plot,
rm_plot,
nrow = 1,
top = text_grob("St. Thomas and St. John",
face = "bold", size = 24, hjust = 0.23))
ggsave(plot=plot_spp_demo,
paste("STTSTJ.den_mort_size_spp_", ".jpeg", sep=""),
path = "C:/Users/Lexie.Sturm/Documents/GitHub/NCRMP-USVI-PR-Tech-Memo/figs",
width = 18,
height = 12.5,
dpi = 300)
############################################### STT STJ ############################################
STTSTJ_ble_prev |>
filter(YEAR == max(YEAR)) |>
ggplot(aes(x = reorder(species_name, avBlePrev),
y = avBlePrev)) +
geom_bar(stat = "identity",
fill = "deepskyblue4") +
geom_errorbar(data = STTSTJ_ble_prev |>
filter(YEAR == max(YEAR)),
aes(x = reorder(species_name, avBlePrev),
ymin = avBlePrev,
ymax = avBlePrev+SE_B),
width = 0.1) +
coord_flip() +
guides(fill = FALSE) +
labs(y = "Bleaching prevalence (%)",
x = "",
title = "St. Thomas & St. John") +
scale_y_continuous(expand = c(0, 0),
limits = c(0, 45)) +
theme_Publication(base_size = 20) +
theme(axis.text.y = element_text(face ="italic")) -> bp1
bp1
############################################### STT STJ ############################################
STTSTJ_ble_prev |>
filter(YEAR == max(YEAR)) |>
ggplot(aes(x = reorder(species_name, avBlePrev),
y = avBlePrev)) +
geom_bar(stat = "identity",
fill = "deepskyblue4") +
geom_errorbar(data = STTSTJ_ble_prev |>
filter(YEAR == max(YEAR)),
aes(x = reorder(species_name, avBlePrev),
ymin = avBlePrev,
ymax = avBlePrev+SE_B),
width = 0.1) +
coord_flip() +
guides(fill = FALSE) +
labs(y = "Bleaching prevalence (%)",
x = "",
title = "St. Thomas & St. John") +
scale_y_continuous(expand = c(0, 0),
limits = c(0, 45)) +
theme_Publication(base_size = 20) +
theme(axis.text.y = element_text(face ="italic")) -> bp1
bp1
ggsave("STTSTJ.plot.bleach.jpeg",
path = "~/Desktop/OneDrive - University of Miami/NOAA/DataSummaries/K/_BioGeoProjects/NCRMP/Data Analysis/Figures/Carib2023",
width = 10,
height = 10,
dpi = 300)
setwd(dirname(rstudioapi::getActiveDocumentContext()$path))
getwd()
